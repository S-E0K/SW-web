<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard (EJS)</title>
  <!-- 정적 CSS -->
  <link rel="stylesheet" href="/style.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <!-- data-* 속성에 unescaped JSON 문자열 삽입 -->
  <div
    id="dashboard"
    class="container"
    data-sales='<%- JSON.stringify(salesData) %>'
    data-users='<%- JSON.stringify(userData)  %>'
  >
    <header>내 대시보드 (EJS)</header>
    <aside>
      <nav>
        <ul>
          <li>홈</li>
          <li>통계</li>
          <li>설정</li>
        </ul>
      </nav>
    </aside>
    <main>
      <div class="card">
        <h3>월별 매출</h3>
        <canvas id="salesChart"></canvas>
      </div>
      <div class="card">
        <h3>사용자 증가</h3>
        <canvas id="userChart"></canvas>
      </div>
    </main>
  </div>

  <script>
    // data- 속성에서 JSON 파싱
    const dashEl   = document.getElementById('dashboard');
    const salesData = JSON.parse(dashEl.dataset.sales);
    const userData  = JSON.parse(dashEl.dataset.users);

    // 차트 렌더링
    const salesCtx = document.getElementById('salesChart').getContext('2d');
    new Chart(salesCtx, {
      type: 'line',
      data: {
        labels: ['1월', '2월', '3월'],
        datasets: [{ label: '매출', data: salesData }]
      }
    });

    const userCtx = document.getElementById('userChart').getContext('2d');
    new Chart(userCtx, {
      type: 'bar',
      data: {
        labels: ['1월', '2월', '3월'],
        datasets: [{ label: '신규 사용자', data: userData }]
      }
    });
  </script>
</body>
</html>
